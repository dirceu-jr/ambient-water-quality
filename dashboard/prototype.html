<!DOCTYPE html>
<head>    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>Observadores de Rios - Protótipos</title>
    <link rel="icon" href="./assets/img/favicon.png" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script> -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://rawcdn.githack.com/python-visualization/folium/master/folium/templates/leaflet.awesome.rotate.css"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <style>
        html, body {width: 100%;height: 100%;margin: 0;padding: 0;}
        #map {position:absolute;top:0;bottom:0;right:0;left:0;}
        #map {
            position: relative;
            width: 100.0%;
            height: 100.0%;
            left: 0.0%;
            top: 0.0%;
        }
    </style>
        
    <script src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script>
</head>
<body>    
    <div class="folium-map" id="map"></div>
</body>
<script>
    var map = L.map(
        "map",
        {
            center: [-24.7574861, -51.7596274], 
            zoom: 7
        }
    );

    // "https://tiles.wmflabs.org/hikebike/{z}/{x}/{y}.png",
    var tile_layer = L.tileLayer(
       "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
        {
            attribution: "Dados por \u0026copy; \<a href=\"http://openstreetmap.org\"\> OpenStreetMap",
            detectRetina: true,
            maxNativeZoom: 18,
            maxZoom: 21,
            minZoom: 0,
            subdomains: "abc"
        }
    ).addTo(map);

    // var heat_map_3ea8834da73b42128acfbc922bb0991b = L.heatLayer(
    //     [
    //         [-25.412536, -49.270274, 10],
    //         [-24.7574861, -51.7596274, 100]
    //     ],
    //     {
    //         blur: 15,
    //         max: 1.0,
    //         maxZoom: 18,
    //         minOpacity: 0.5,
    //         radius: 25
    //     }
    // ).addTo(map);

    // var circle_1 = L.circle(
    //     [-25.413852, -49.270339],
    //     {
    //         color: "#00FF69",
    //         radius: 20
    //     }
    // ).addTo(map);

    // circle_1.bindTooltip(
    //     "<div>Nível: 50cm - Chuva: 10mm</div>",
    //     { sticky: true }
    // );

    $.ajax({
        url: "./data/sub_bacias_altoiguacupoligono.json"
    }).done(function(data) {
        L.geoJSON(data, {
            style: {
                fillOpacity: 0.1,
                color: "#417fc2",
                weight: 3,
                opacity: 0.5
            },
            onEachFeature: function (feature, layer) {
                layer.on('mouseover', function () {
                    // bacia hidrogrfica
                    layer.bindPopup(feature.properties.SUBNOME.toLowerCase().capitalize());
                    this.setStyle({
                        'fillColor': '#0000ff'
                    });
                });
                layer.on('mouseout', function () {
                    this.setStyle({
                        'fillColor': '#417fc2'
                    });
                });
                // layer.on('click', function () {
                //     // Let's say you've got a property called url in your geojsonfeature:
                //     window.location = feature.properties.url;
                // });
            }
        }).addTo(map);
    });

    String.prototype.capitalize = function() {
        return this.replace(/(^\w|\s\w)/g, m => m.toUpperCase());
    }
</script>